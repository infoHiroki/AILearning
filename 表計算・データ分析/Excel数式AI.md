# 🎯 Excel関数 × AI活用 〜完全初心者でも複雑な関数が作れる！〜

**所要時間**: 45分  
**レベル**: 完全初心者（関数知識不要）  
**前提知識**: Excelの基本操作（セルの入力、コピー&ペースト程度）

- Excel関数って何？を身近な例で理解する
- AIにお願いして関数を作ってもらう方法を覚える
- 実際に業務で使える関数を作成する
- エラーが出ても慣てず対処できるようになる

---

## 📊 Excel関数って何？なぜAIと組み合わせると効果的なの？

### 身近な例で理解しよう

#### あなたが毎日やっている計算作業
- **売上集計**: ①各商品の売上を確認 → ②電卓で合計計算 → ③ランキング作成
- **請求書作成**: ①単価×数量を計算 → ②消費税を計算 → ③割引を適用
- **在庫管理**: ①入荷数を確認 → ②出荷数を引く → ③残数を計算

これら全て「**毎回同じ計算の繰り返し**」ですよね？

### Excel関数 = 計算作業を自動化する仕組み

#### 人間がやること vs 関数がやること

**人間がやること（大変...）**:
- 毎日同じ計算を手作業で繰り返し
- 電卓片手に「えーっと...」と時間をかける
- 計算ミスがないかドキドキしながらチェック

**関数がやること（楽々！）**:
- 数式を一度作れば後は全自動
- 大量のデータも一瞬で計算完了
- 計算ミスゼロで正確な結果

### 簡単に言うと...
**Excel関数 = 計算を自動化するロボット。AIがそのロボットの設計図を作ってくれる！**

### 📋 関数の基本構造（もう怖くない！）

**どんな関数でも、基本はこのパターンです**:
```excel
=関数名(中身1, 中身2, ...)
```

**日常会話で理解すると**:
```excel
=SUM(A1:A10)  → 「A1からA10までを全部足して」
=IF(B2>100, "合格", "不合格")  → 「もしB2が100より大きいなら合格、そうでなければ不合格」
```

**つまり**: =は「計算して！」、関数名は「何をしたいか」、カッコの中は「具体的な指示」です。

### 📝 よく使う基本関数たち（これだけ覚えれば十分！）

**安心してください**: 全部覚える必要はありません。AIが作ってくれるので、「あぁ、こんな機能もあるんだ」程度の理解でOKです！

#### 🧮 計算系（毎日使う！）
```excel
=SUM(A1:A10)      ' 合計を計算
=AVERAGE(A1:A10)  ' 平均を計算
=COUNT(A1:A10)    ' 数値の個数を数える
=MAX(A1:A10)      ' 最大値を取得
=MIN(A1:A10)      ' 最小値を取得
```

#### 🤔 論理系関数（「もし〜なら」の判断）
```excel
=IF(条件, 真の場合, 偽の場合)
=AND(条件1, 条件2)  ' すべての条件が真の場合にTRUE
=OR(条件1, 条件2)   ' いずれかの条件が真の場合にTRUE
```

#### 📝 文字列系関数（文字いじり）
```excel
=LEN(A1)          ' 文字数を数える
=LEFT(A1, 3)      ' 左から3文字を取得
=RIGHT(A1, 3)     ' 右から3文字を取得
=MID(A1, 2, 3)    ' 2文字目から3文字を取得
```

#### 🔍 検索系関数（探し物）
```excel
=VLOOKUP(検索値, 表範囲, 列番号, FALSE)
=INDEX(範囲, 行番号, 列番号)
=MATCH(検索値, 検索範囲, 0)
```

### 📍 セル参照の種類（意外と重要！）

#### 相対参照
```excel
=A1+B1
```
コピー時に参照するセルが自動的に移動

#### 絶対参照
```excel
=$A$1+$B$1
```
コピー時でも参照するセルが固定

#### 混合参照
```excel
=$A1+B$1
```
行または列のどちらかを固定

### ⌨️ 関数の入力方法（どれが一番楽？）

#### 1. 直接入力
1. セルをクリック
2. `=`を入力
3. 関数名と引数を入力
4. `Enter`キーで確定

#### 2. 関数ウィザードを使用
1. セルを選択
2. `数式`タブ → `関数の挿入`
3. 関数を選択して設定
4. `OK`で確定

#### 3. オートコンプリート機能
- `=SU`と入力すると候補が表示される
- `Tab`キーで選択、`Enter`で確定

### 😱 エラーの種類と対処（怖がらないで！）

**大事なこと**: エラーが出たらAIに「このエラーを直して」とお願いしましょう。自分で解決しようとしないでOK！

```excel
#VALUE!  ' 引数の型が間違っている
#DIV/0!  ' 0で割り算している
#N/A     ' 検索値が見つからない
#REF!    ' 参照先のセルが削除されている
#NAME?   ' 関数名が間違っている
```

---

## 🤖 AIにExcel関数を作ってもらう方法（ここが一番重要！）

### 🎯 AIへの上手なお願いの仕方（テンプレート）

**このテンプレートをコピペして使ってください！**

```
Excel関数を作成してください。初心者なので、分かりやすく教えてください。

【やりたいこと】
普段手作業でやっている○○を自動化したい

【Excelの状況】
- A列: [例: 顧客名]
- B列: [例: 購入金額]
- C列: [例: 購入日]

【やりたい判定】
[例: 金額に応じて「優良顧客」「一般顧客」と判定したい]

【結果を表示したい場所】
D列に結果を表示したい

【お願い】
関数式と簡単な使い方の説明をお願いします。
```

**ポイント**: 「初心者なので」と最初に書くと、AIが丁寧に説明してくれます！

### 🌟 実際にAIに関数を作ってもらおう！（実用例）

#### 例1: 「売上金額でランク付けしたい」

**よくある悩み**: 「営業成績をA・B・C・Dの4段階で判定したいけど、手作業で一つずつ確認するのが大変...」

**AIへのお願い**:
```
Excel関数を作成してください。初心者なので、分かりやすく教えてください。

【やりたいこと】
営業担当者の売上金額でランク付けを自動化したい

【Excelの状況】
- A列: 担当者名
- B列: 月間売上金額（数字）
- C列: ランクを表示したい

【ランク付けルール】
- 100万円以上: Aランク
- 50万円以上: Bランク
- 30万円以上: Cランク
- それ未満: Dランク

【お願い】
C列に入れる関数と、使い方を教えてください。
```

**AIが作ってくれる関数**:
```excel
=IF(B2>=1000000,"A",IF(B2>=500000,"B",IF(B2>=300000,"C","D")))
```

**使い方の説明**:
1. C2セルに上記の関数を入力
2. Enterキーで確定
3. C2セルをコピーして、他の行に貼り付け
4. 全員のランクが一瞬で表示！

#### 例2: 「営業成績を総合的に判定したい」（複数条件）

**よくある悩み**: 「売上だけじゃなくて、新規顧客数や顧客満足度も含めて総合的に評価したい...」

**AIへのお願い**:
```
Excel関数を作成してください。初心者なので、分かりやすく教えてください。

【やりたいこと】
営業担当者の成績を総合的に評価してランク付けしたい

【Excelの状況】
- A列: 担当者名
- B列: 月間売上金額
- C列: 新規顧客獲得数
- D列: 顧客満足度（1～5の数字）
- E列: 評価結果を表示したい

【評価ルール】
- 優秀: 売上500万円以上 かつ 新規顧客10件以上 かつ 満足度4以上
- 良好: 売上300万円以上 かつ 新規顧客5件以上 かつ 満足度3以上
- 標準: 上記以外

【お願い】
3つの条件を全て満たしているかをチェックする関数を作ってください。
```

**AIが作ってくれる関数**:
```excel
=IF(AND(B2>=5000000,C2>=10,D2>=4),"優秀",
 IF(AND(B2>=3000000,C2>=5,D2>=3),"良好","標準"))
```

**解説**:
- `AND()`関数で「全ての条件を満たしているか」をチェック
- 最初に優秀かどうか、次に良好かどうかを順番に判定
- どちらでもなければ標準

**すごいところ**: 手作業なら100人分確認するのに1時間かかるけど、この関数なら一瞬！

---

## 💼 実際の業務で使える！便利関数集

### 📈 集計・分析系（データをさくっとまとめる）

#### 「特定の商品、特定の地域だけの売上を知りたい」

**プロンプト**:
```
商品別・地域別の売上集計を行いたいです。

【データ】
- A列: 商品名
- B列: 地域  
- C列: 売上金額

【条件】
特定の商品（F1セル）と特定の地域（G1セル）の売上合計を求めたいです。
```

**AI生成例**:
```excel
=SUMIFS(C:C,A:A,F1,B:B,G1)
```

#### 動的な順位付け

**プロンプト**:
```
売上ランキングを自動化したいです。

【要件】
- B列の売上金額を降順でランク付け
- 同順位がある場合は同じ順位
- 空白セルは除外

C列にランクを表示してください。
```

**AI生成例**:
```excel
=IF(B2="","",RANK(B2,B:B,0))
```

### 📅 日付・時間系（スケジュール管理に必需）

#### 「土日祝を除いて納期を計算したい」

**プロンプト**:
```
納期管理に使える関数を作成してください。

【要件】
- A列: 受注日
- B列: 製造日数（営業日ベース）
- C列: 納期（営業日で計算、土日祝除く）

日本の祝日は考慮せず、土日のみ除外してください。
```

**AI生成例**:
```excel
=WORKDAY(A2,B2)
```

#### 「プロジェクトの遅れを自動で判定したい」

**プロンプト**:
```
プロジェクトの進捗管理用の関数を作成してください。

【データ】
- A列: 開始日
- B列: 終了予定日
- C列: 現在の進捗率（%）

【計算したいもの】
D列: 予定通り進んでいるかの判定（「順調」「遅れ」「完了」）
```

**AI生成例**:
```excel
=IF(C2>=100,"完了",
 IF(C2>=(TODAY()-A2)/(B2-A2)*100,"順調","遅れ"))
```

---

## 🚨 エラーが出ても大丈夫！AIに直してもらおう

### 😱 よくあるエラーの直し方（AIが面倒見ます）

#### 「#VALUE!エラーが出ました」の直し方

**よくある状況**: 「金額データで判定しようとしたら#VALUE!エラーが...」

**AIへのお願い**:
```
以下のExcel関数でエラーが出ます。初心者なので、修正方法を教えてください。

【エラーが出る関数】
=IF(A2>100000,"高","低")

【状況】
- A列には金額の数字が入っているはず
- 一部のセルに「未入力」や「-」などの文字が入っているかも
- そのせいで#VALUE!エラーが出る

【希望】
エラーが出ても「データエラー」などと表示して、止まらないようにしたいです。
```

**AIが修正してくれる関数**:
```excel
=IF(ISNUMBER(A2),IF(A2>100000,"高","低"),"データエラー")
```

**解説**:
- `ISNUMBER(A2)` ← A2が数字かどうかを最初にチェック
- 数字なら普通に判定、数字でなければ「データエラー」と表示
- これでどんなデータが入っていても関数が止まらない！

#### 「#N/Aエラーが出ました」の直し方

**よくある状況**: 「VLOOKUPで顧客情報を探そうとしたら#N/Aエラーが...」

**AIへのお願い**:
```
VLOOKUP関数でエラーが出ます。初心者なので、修正方法を教えてください。

【現在の関数】
=VLOOKUP(A2,Sheet2!A:B,2,FALSE)

【問題】
顧客IDで顧客名を探しているが、存在しないIDだと#N/Aエラーが出る

【希望】
見つからない場合は「該当なし」や「未登録」と表示したいです。
```

**AIが修正してくれる関数**:
```excel
=IFERROR(VLOOKUP(A2,Sheet2!A:B,2,FALSE),"該当なし")
```

**解説**:
- `IFERROR()` ← エラーが出たら指定した文字を表示する関数
- VLOOKUPが成功すれば普通に顧客名、失敗したら「該当なし」
- これでエラーが出ても見た目がきれい！

### 🚀 関数の高速化（処理が遅いときのAI活用）

#### 「関数が重くてExcelが固まる」の解決策

**よくある困りごと**: 「集計関数を作ったら、Excelが固まって動かなくなった...」

**AIへのお願い**:
```
Excel関数が重くて困っています。初心者なので、高速化の方法を教えてください。

【現在使っている関数】
=SUMPRODUCT((Sheet1!A:A=A2)*(Sheet1!B:B=B2)*Sheet1!C:C)

【状況】
- 5000行のデータがある
- この関数を500行で使用
- 計算に時間がかかりすぎてExcelが固まる

【希望】
同じ結果が出るけど、もっと高速な関数に変えたいです。
```

**AIが最適化してくれる関数**:
```excel
=SUMIFS(Sheet1!C:C,Sheet1!A:A,A2,Sheet1!B:B,B2)
```

**解説**:
- `SUMIFS()` ← 条件付き集計の専用関数（超高速）
- SUMPRODUCTよりずっと高速で、同じ結果が出る
- **高速化の效果**: 10秒かかっていた計算が1秒で完了！

---

## 🏢 業種別：実際に使える便利関数

### 📈 営業・売上管理部門向け

#### 「目標達成率を自動表示したい」

**プロンプト**:
```
売上目標の達成状況を表示する関数を作成してください。

【データ】
- B列: 月間売上実績
- C列: 月間売上目標

【表示したいもの】
- D列: 達成率（%表示）
- E列: 達成状況（「達成」「未達成」「大幅未達成（80%未満）」）
```

**AI生成例**:
```excel
D列: =IF(C2=0,"",B2/C2)
E列: =IF(D2="","",IF(D2>=1,"達成",IF(D2>=0.8,"未達成","大幅未達成")))
```

### 📦 在庫・購買管理部門向け

#### 「在庫が少なくなったら自動で発注アラート」

**プロンプト**:
```
在庫管理の発注判定を自動化したいです。

【データ】
- A列: 商品名
- B列: 現在庫数
- C列: 安全在庫数
- D列: 発注ロット

【判定ルール】
現在庫が安全在庫を下回ったら「発注必要」
発注数量は発注ロットの倍数で、安全在庫の2倍になるように計算
```

**AI生成例**:
```excel
E列（発注判定）: =IF(B2<=C2,"発注必要","在庫十分")
F列（発注数量）: =IF(E2="発注必要",CEILING((C2*2-B2),D2),"")
```

---

## 🎓 練習問題（実際にチャレンジ！）

### 💰 練習1: 給与計算システムを作ってみよう

**チャレンジしてみてください！**

```
【データ】
- A列: 従業員名
- B列: 基本給
- C列: 残業時間
- D列: 営業成績（売上金額）

【計算ルール】
- 残業代: 基本給÷160時間×1.25×残業時間
- 営業手当: 売上500万円以上で基本給の10%、300万円以上で5%
- 総支給額 = 基本給 + 残業代 + 営業手当

【AIへのお願い方法】
上記の条件をもとに、あなた自身でAIに関数作成をお願いしてみてください！
「初心者なので...」を忘れずに。

【作成してほしい関数】
- E列（残業代）: 基本給÷160×1.25×残業時間
- F列（営業手当）: 売上に応じた手当
- G列（総支給額）: 全部の合計 
```

### 📊 練習2: 顧客分析システムを作ってみよう

**さらにレベルアップ！**

```
【データ】
- A列: 顧客ID
- B列: 最終購入日
- C列: 購入回数
- D列: 累計購入金額

【分析項目】
- E列: 最終購入からの経過日数
- F列: 顧客ランク（VIP: 100万円以上、優良: 50万円以上、一般: それ以外）
- G列: アクション判定（90日以上購入なしで「要フォロー」）

【AIへのお願い方法】
今度は自分でテンプレートを使ってAIにお願いしてみてください。

【ヒント】
- 「経過日数」は「今日-最終購入日」
- 「90日以上購入なし」は条件判定でOK

【作成してほしい関数】
- E列: 最終購入からの経過日数
- F列: 顧客ランク判定
- G列: フォローが必要かどうかの判定 
```

---

## 🎉 おめでとうございます！Excel関数×AIマスターの仲間入り

### 今日できるようになったこと

1. **Excel関数の基本** → 身近な例で理解できた ✅
2. **AIへのお願い方法** → テンプレートを覚えた ✅
3. **エラー対処** → AIに直してもらえるようになった ✅
4. **実用関数作成** → 5つのパターンを体験 ✅

### Excel関数×AIの成功のコツ

#### ✅ AIに伝えるときのポイント
- **「初心者なので」**と最初に宣言
- **具体的な状況**を詳しく説明
- **エラー対策**も一緒にお願い
- **使い方**も教えてもらう

#### ✅ 関数を使うときのポイント
- **小さなデータ**でまずテスト
- **コピー前にセル参照**を確認
- **エラーが出ても慌てない**（AIに聞けばOK）

### 次のステップ

#### すぐにできること
1. **今日の内容を実際に試す**（手を動かすのが一番！）
2. **職場の手作業計算を1つ見つけてAIに関数作成をお願い**
3. **同僚に「関数作れるようになった」と自慢**

#### さらにスキルアップしたい方
- **[Excel VBA×AI](ExcelVBA・AI.md)**: さらに高度な自動化
- **[データ分析](データ分析.md)**: 本格的なデータ活用
- **[Excel分析AI](Excel分析AI.md)**: データ分析の自動化

---

**🎊 あなたは今、「手作業計算」から「関数自動化」への第一歩を踏み出しました！**

明日から職場で「その計算、関数で自動化できますよ」と言えるあなたに変身です！